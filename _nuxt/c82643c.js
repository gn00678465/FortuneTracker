(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{216:function(t,e,r){"use strict";r.r(e);r(31),r(22),r(74),r(12);var o=r(2),n=r(25);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={props:{showDots:{type:Boolean,default:!0}},data:function(){return{weekDate:["SUN","MON","TUE","WED","THU","FRI","SAT"],today:void 0,currentDate:void 0,selectDate:void 0,classes:{select:"font-bold bg-primary text-secondary rounded focus:outline-none",today:"font-bold text-primary","out-of-month":"text-white text-opacity-25 cursor-auto"}}},computed:{makeCalendar:function(){for(var t=this.$moment(this.currentDate).date(1).day(),e=[],i=0;i<42;i++){var r=this.$moment(this.currentDate).date(1).subtract(t,"days").add(i,"days");e.push(this.date2Obj(r))}return e},mixCalendar:function(){var t=this,e=this.$store.getters["firebase/sortByDateAndCount"];return this.makeCalendar.map((function(r){var o=t.$moment(r).unix();return o in e?l(l({},r),e[o]):l(l({},r),{},{expense:null,income:null})}))},isBefore:function(){return this.$moment(this.currentDate).add(1,"months").date(1)},isAfter:function(){return this.$moment(this.currentDate).date(1)},dateRange:{get:function(){return[this.date2unix(this.isAfter),this.date2unix(this.isBefore)]}}},created:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.today=t.date2Obj(),t.$route.path.match("/admin/record")?t.selectDate=t.currentDate=t.$store.state.firebase.currentSelectDate||t.date2Obj():t.selectDate=t.currentDate=t.today,t.commitStore("firebase/SET_CURRENTSELECTDATE",t.today),t.commitStore("firebase/SET_CURRENTDATERANGE",t.dateRange),e.next=6,t.$store.dispatch("firebase/getRangeData");case 6:if(t.$store.state.firebase.allCategories){e.next=9;break}return e.next=9,t.$store.dispatch("firebase/getAllCategories");case 9:case"end":return e.stop()}}),e)})))()},methods:{date2Obj:function(t){var e=this.$moment(t).toObject();return{years:e.years,months:e.months,date:e.date}},date2unix:function(t){return this.$moment(t).unix()},dateIsSame:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";return this.$moment(t).isSame(e,r)},changeMonth:function(t){var e=t?"add":"subtract",r=this.$moment(this.currentDate)[e](1,"months").toObject(),o=r.years,n=r.months,c=r.date;this.currentDate={years:o,months:n,date:c},this.commitStore("firebase/SET_CURRENTDATERANGE",this.dateRange),this.$store.dispatch("firebase/getRangeData")},setClass:function(t){return this.dateIsSame(t,this.selectDate)?"select":this.dateIsSame(t,this.today)?"today":this.$moment(t).isBetween(this.isAfter,this.isBefore,void 0,"[)")?void 0:"out-of-month"},setToday:function(){this.currentDate=this.selectDate=this.today},selectCurrentDate:function(t){this.selectDate=t,this.commitStore("firebase/SET_CURRENTSELECTDATE",t),this.$emit("datepicker_close")},commitStore:function(t,e){this.$store.commit(t,e)}}},m=r(30),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bg-secondary"},[r("div",{staticClass:"bg-primary flex justify-between items-center rounded font-medium text-xl"},[r("button",{staticClass:"material-icons py-3 rounded-l px-2 focus:outline-none",on:{click:function(e){return t.changeMonth(!1)}}},[t._v("\n      chevron_left\n    ")]),t._v(" "),r("p",[t._v(t._s(t.$moment(t.currentDate).format("YYYY 年 MM 月")))]),t._v(" "),r("button",{staticClass:"material-icons py-3 rounded-r px-2 focus:outline-none",on:{click:function(e){return t.changeMonth(!0)}}},[t._v("\n      chevron_right\n    ")])]),t._v(" "),r("ul",{staticClass:"text-center text-white grid grid-cols-7 gap-x-2"},t._l(t.weekDate,(function(e){return r("li",{key:e,staticClass:"py-2"},[t._v("\n      "+t._s(e)+"\n    ")])})),0),t._v(" "),r("ul",{staticClass:"text-center text-white flex-wrap grid grid-cols-7 gap-x-2 gap-y-1"},t._l(t.mixCalendar,(function(e){return r("li",{key:e.months+"-"+e.date},[r("button",{staticClass:"w-full pt-1.5 pb-2.5 text-md relative",class:t.classes[t.setClass(e)],attrs:{type:"button",disabled:"out-of-month"===t.setClass(e)},on:{click:function(r){return t.selectCurrentDate(e)}}},[r("p",[t._v(t._s(10>e.date?"0"+e.date:e.date))]),t._v(" "),r("p",{directives:[{name:"show",rawName:"v-show",value:t.showDots&&"out-of-month"!==t.setClass(e),expression:"showDots && setClass(date) !== 'out-of-month'"}]},[r("span",{directives:[{name:"show",rawName:"v-show",value:e.expense,expression:"date.expense"}],staticClass:"absolute bottom-1 left-1/3 w-1.5 h-1.5 rounded-full bg-expense"}),t._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:e.income,expression:"date.income"}],staticClass:"absolute bottom-1 right-1/3 w-1.5 h-1.5 rounded-full bg-income"})])])])})),0),t._v(" "),r("div",{staticClass:"flex justify-between items-center"},[r("p",{directives:[{name:"show",rawName:"v-show",value:t.showDots,expression:"showDots"}],staticClass:"text-white ml-3 mr-2"},[r("span",{staticClass:"w-1.5 h-1.5 bg-expense rounded-full inline-block align-middle mr-1"}),t._v("\n      支出\n    ")]),t._v(" "),r("p",{directives:[{name:"show",rawName:"v-show",value:t.showDots,expression:"showDots"}],staticClass:"text-white"},[r("span",{staticClass:"w-1.5 h-1.5 rounded-full bg-income inline-block align-middle mr-1"}),t._v("\n      收入\n    ")]),t._v(" "),r("button",{staticClass:"focus:outline-none ative:outline-none text-primary ml-auto mr-3 mb-1",attrs:{type:"button"},on:{click:t.setToday}},[r("span",{staticClass:"material-icons align-bottom"},[t._v("home")]),t._v(" "),r("span",[t._v("回到今天")])])])])}),[],!1,null,null,null);e.default=component.exports},241:function(t,e,r){"use strict";r.r(e);var o={props:{id:{type:String,required:!0},value:{type:String,required:!0}},data:function(){return{show:!1}}},n=r(30),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"relative"},[r("input",{staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md py-2 pl-10 pr-2\n      focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50\n        transition-all duration-300",attrs:{id:t.id,type:"text"},domProps:{value:t.value},on:{focus:function(e){if(e.target!==e.currentTarget)return null;t.show=!0}}}),t._v(" "),r("span",{staticClass:"text-white material-icons absolute top-1/2 transform -translate-y-1/2 left-3"},[t._v("date_range")])]),t._v(" "),r("transition",{attrs:{"enter-active-class":"transition ease-out duration-100","enter-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"}},[t.show?r("Calendar",{staticClass:"z-10 absolute left-2 right-2 border border-solid border-primary rounded-md mt-2 bg-secondary",attrs:{"show-dots":!1},on:{datepicker_close:function(e){t.show=!1}}}):t._e()],1),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"absolute top-0 bottom-0 left-0 right-0",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.show=!1}}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Calendar:r(216).default})},247:function(t,e,r){"use strict";r.r(e);r(68),r(12);var o=r(2),n={data:function(){return{formData:{isExpense:!0,price:null,name:null,category:null,subcategory:null,notes:null,store:null,tags:[]}}},fetch:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.store).state.firebase.allCategories){e.next=4;break}return e.next=4,r.dispatch("firebase/getAllCategories");case 4:case"end":return e.stop()}}),e)})))()},computed:{isLogin:function(){return this.$store.getters["users/isLogin"]},isEdit:function(){return"id"in this.$route.params},currentDate:function(){var t=this.$store.state.firebase.currentSelectDate;return this.$moment(t).format("YYYY-MM-DD")},expenseCategories:function(){return this.$store.getters["firebase/expenseCategories"]},incomeCategories:function(){return this.$store.getters["firebase/incomeCategories"]},expenseSubcategories:function(){var t=this;return this.formData.isExpense&&0!==this.expenseCategories.length&&this.formData.category?this.expenseCategories.filter((function(e){return e.id===t.formData.category}))[0].subcategories:[]},computeExpenseCategory:{get:function(){return this.formData.category},set:function(t){this.formData.category=t,this.formData.subcategory=this.expenseSubcategories[0].id}},computeExpenseSubcategory:{get:function(){return this.formData.subcategory},set:function(t){this.formData.subcategory=t}},computeIncomeCategory:{get:function(){return this.formData.category},set:function(t){this.formData.category=t}}},created:function(){var t=this;this.isEdit&&this.$store.dispatch("firebase/getOneData",{id:this.$route.params.id}).then((function(data){t.formData=data}))},methods:{submitData:function(){var t=this,e=this.formData,r=e.isExpense,o=e.price,n=e.category,c=e.subcategory;if(o&&n||r&&c){var l=this.isEdit?"firebase/updateData":"firebase/setNewData",d={data:this.formData,id:this.$route.params.id||void 0};this.$store.dispatch(l,d).then((function(){t.resetForm(),t.$router.push("/admin")}))}},resetForm:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.formData={isExpense:t,price:null,name:null,category:null,subcategory:null,notes:null,store:null,tags:[]}},changeTab:function(t){this.resetForm(),this.formData.isExpense="true"===t.target.dataset.expense}}},c=r(30),component=Object(c.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ul",{staticClass:"flex text-center border-2 border-solid border-primary rounded-lg divide-x-2 divide-primary mb-5"},[r("li",{staticClass:"flex-grow"},[r("button",{staticClass:"py-2 w-full cursor-pointer focus:outline-none font-medium",class:t.formData.isExpense?"bg-primary text-black":"text-white",attrs:{type:"button","data-expense":"true"},on:{click:t.changeTab}},[t._v("\n        支出\n      ")])]),t._v(" "),r("li",{staticClass:"flex-grow"},[r("button",{staticClass:"py-2 w-full cursor-pointer focus:outline-none font-medium",class:t.formData.isExpense?"text-white":"bg-primary text-black",attrs:{type:"button","data-expense":"false"},on:{click:t.changeTab}},[t._v("\n        收入\n      ")])])]),t._v(" "),t.isLogin?t._e():r("p",{staticClass:"text-danger"},[t._v("\n    請先\n    "),r("router-link",{attrs:{to:"/login",custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.navigate;return[r("span",{staticClass:"py-5 cursor-pointer hover:text-info transition duration-300",on:{click:o}},[t._v("\n        登入\n      ")])]}}],null,!1,3239599930)}),t._v("\n    才可新增資料。\n  ")],1),t._v(" "),r("form",{attrs:{action:"POST"},on:{submit:function(e){return e.preventDefault(),t.submitData(e)}}},[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"price"}},[t._v("金額")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.formData.price,expression:"formData.price",modifiers:{number:!0}},{name:"input-filter",rawName:"v-input-filter:price",arg:"price"}],staticClass:"text-white text-2xl text-right w-full bg-secondary border border-solid border-white rounded-md p-2 transition-all duration-300\n        focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",attrs:{id:"price",type:"number",name:"price",placeholder:"0",required:""},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"date"}},[t._v("日期")]),t._v(" "),r("Datepicker",{attrs:{id:"datePicker",value:t.currentDate}})],1),t._v(" "),t.formData.isExpense?[r("div",{staticClass:"flex mb-4"},[r("div",{staticClass:"flex-1 mr-3"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"category"}},[t._v("分類")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.computeExpenseCategory,expression:"computeExpenseCategory"}],staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md p-2",attrs:{id:"category",name:"category",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.computeExpenseCategory=e.target.multiple?r:r[0]}}},t._l(t.expenseCategories,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n              "+t._s(e.name)+"\n            ")])})),0)]),t._v(" "),r("div",{staticClass:"flex-1"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"subcategory"}},[t._v("子分類")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.computeExpenseSubcategory,expression:"computeExpenseSubcategory"}],staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md p-2",attrs:{id:"subcategory",name:"subcategory",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.computeExpenseSubcategory=e.target.multiple?r:r[0]}}},t._l(t.expenseSubcategories,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n              "+t._s(e.name)+"\n            ")])})),0)])])]:[r("div",{staticClass:"flex-1 mb-4"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"category"}},[t._v("分類")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model.trim",value:t.computeIncomeCategory,expression:"computeIncomeCategory",modifiers:{trim:!0}}],staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md p-2",attrs:{id:"category",name:"category",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.computeIncomeCategory=e.target.multiple?r:r[0]}}},t._l(t.incomeCategories,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),0)])],t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"store"}},[t._v("商家")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.store,expression:"formData.store"}],staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md p-2 transition-all duration-300\n        focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",attrs:{id:"store",type:"text",name:"store",placeholder:"請輸入商家名稱"},domProps:{value:t.formData.store},on:{input:function(e){e.target.composing||t.$set(t.formData,"store",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block mb-1 text-white",attrs:{for:"notes"}},[t._v("備註")]),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.notes,expression:"formData.notes",modifiers:{trim:!0}}],staticClass:"text-white w-full bg-secondary border border-solid border-white rounded-md p-2 transition-all duration-300\n        focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",attrs:{id:"notes",type:"text",name:"notes",rows:"5"},domProps:{value:t.formData.notes},on:{input:function(e){e.target.composing||t.$set(t.formData,"notes",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),r("div",{staticClass:"flex"},[r("button",{staticClass:"flex-1 border border-solid border-primary py-2 rounded text-primary mr-2 font-medium\n        transition-colors duration-300 hover:bg-primary hover:text-black focus:outline-none\n        disabled:opacity-60 disabled:border-white disabled:bg-secondary disabled:text-white disabled:cursor-not-allowed",attrs:{type:"submit",disabled:!t.isLogin}},[t.isEdit?[t._v("\n          修改資料\n        ")]:[t._v("\n          新增資料\n        ")]],2),t._v(" "),r("button",{staticClass:"flex-1 border border-solid border-white py-2 rounded text-white font-medium\n        transition-colors duration-300 hover:bg-white hover:text-black focus:outline-none",on:{click:function(e){return e.preventDefault(),t.resetForm(t.formData.isExpense)}}},[t._v("\n        重置\n      ")])])],2)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Datepicker:r(241).default})}}]);